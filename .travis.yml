language: java 
jdk:
  - openjdk7

cache:
  directories:
    - $HOME/.m2
before_cache:
  - rm -rf $HOME/.m2/repository/
before_install:
  - wget http://apache.claz.org/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.tar.gz
  - tar zxvf apache-maven-3.3.9-bin.tar.gz
  - chmod +x apache-maven-3.3.9/bin/mvn
  - export M2_HOME=$PWD/apache-maven-3.3.9
  - export PATH=$PWD/apache-maven-3.3.9/bin:${PATH}
  - hash -r
install:
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

before_deploy:
  # Set up git user name and tag this commit
  - git config --local user.name "Yihy"
  - git config --local user.email "yihy8023@gmail.com"
  - git tag "$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)"
deploy:
  provider: releases
  api_key: "$api_key"
  file: "target/resources_cn-*.jar"
  skip_cleanup: true
